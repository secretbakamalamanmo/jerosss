<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jero App Mobile</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        :root { --primary: #00f2ff; --secondary: #ff00d4; --bg: #0b101b; --glass: rgba(255, 255, 255, 0.05); --border: rgba(255, 255, 255, 0.1); }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); font-family: 'Inter', sans-serif; color: white; overflow: hidden; }
        
        #bgCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }

        /* Login Screen */
        .auth-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; justify-content: center; align-items: center; padding: 20px; transition: 0.5s; }
        .auth-card { background: var(--glass); backdrop-filter: blur(20px); padding: 30px; border-radius: 30px; border: 1px solid var(--border); width: 100%; max-width: 350px; text-align: center; }

        /* Bottom Navigation Bar */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: rgba(11, 16, 27, 0.95); backdrop-filter: blur(15px); border-top: 1px solid var(--border); display: none; justify-content: space-around; align-items: center; z-index: 900; padding-bottom: 10px; }
        .nav-btn { color: #6a7282; font-size: 0.65rem; display: flex; flex-direction: column; align-items: center; cursor: pointer; border: none; background: none; transition: 0.3s; }
        .nav-btn.active { color: var(--primary); }
        .nav-btn i { font-size: 1.5rem; margin-bottom: 4px; }

        /* Main Sections */
        .content-area { flex: 1; height: 100%; overflow-y: auto; padding: 25px; padding-bottom: 100px; display: none; }
        .section-title { font-size: 1.8rem; font-weight: 900; margin-bottom: 15px; background: linear-gradient(to right, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* Mobile Inputs & Buttons */
        input { width: 100%; padding: 16px; margin-bottom: 12px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 15px; color: white; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--primary); background: rgba(255,255,255,0.1); }
        .btn-main { width: 100%; padding: 16px; background: linear-gradient(90deg, var(--primary), var(--secondary)); border: none; border-radius: 15px; color: white; font-weight: 800; font-size: 1rem; cursor: pointer; box-shadow: 0 10px 20px rgba(0, 242, 255, 0.2); }
        
        .card { background: var(--glass); border: 1px solid var(--border); padding: 20px; border-radius: 20px; margin-bottom: 15px; }
        .task-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(255,255,255,0.03); border-radius: 15px; margin-bottom: 10px; border-left: 4px solid var(--primary); }
        
        /* Game Styles */
        #birdCanvas { width: 100%; border-radius: 20px; background: #000; touch-action: none; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .hidden { display: none !important; }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        .shake { animation: shake 0.3s; border-color: #ff4757 !important; }
    </style>
</head>
<body>
    <canvas id="bgCanvas"></canvas>

    <div id="authScreen" class="auth-overlay">
        <div class="auth-card">
            <h1 style="margin:0; color:var(--primary); font-size: 2rem;">Jero Mobile</h1>
            <p style="color:var(--secondary); font-weight:bold; margin-bottom:25px;">ily mj</p>
            
            <div id="loginForm">
                <input type="text" id="user" placeholder="Username">
                <input type="password" id="pass" placeholder="Password">
                <button class="btn-main" onclick="handleLogin()">LOGIN APP</button>
                <p style="font-size:0.85rem; margin-top:20px" onclick="toggleAuth()">New here? <span style="color:var(--primary)">Register</span></p>
            </div>

            <div id="regForm" class="hidden">
                <input type="text" id="regU" placeholder="New Username">
                <input type="password" id="regP" placeholder="New Password">
                <button class="btn-main" onclick="handleReg()">CREATE ACCOUNT</button>
                <p style="font-size:0.85rem; margin-top:20px" onclick="toggleAuth()">Go back to <span style="color:var(--primary)">Login</span></p>
            </div>
        </div>
    </div>

    <div id="plannerSec" class="content-area">
        <div class="section-title">Planner</div>
        <div class="card">
            <input type="text" id="taskName" placeholder="Mission Name...">
            <button class="btn-main" onclick="addTask()">ADD TO SHEET</button>
        </div>
        <div id="taskList"></div>
    </div>

    <div id="gameSec" class="content-area">
        <div class="section-title">Flappy Jero</div>
        <div style="position: relative;">
            <canvas id="birdCanvas" width="320" height="480"></canvas>
            <div id="scoreLabel" style="position: absolute; top: 20px; left: 20px; font-size: 24px; font-weight: 900; color: var(--primary);">Score: 0</div>
        </div>
        <button class="btn-main" style="margin-top: 15px;" onclick="initBird()">TAP TO START / RESTART</button>
    </div>

    <div id="bottomNav" class="bottom-nav">
        <div class="nav-btn active" onclick="showTab('planner')"><i>üìã</i>Planner</div>
        <div class="nav-btn" onclick="showTab('game')"><i>üéÆ</i>Game</div>
        <div class="nav-btn" onclick="location.reload()" style="color:#ff4757"><i>üö™</i>Exit</div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyDVCuoE5uOFiHUITez_7B0jQDNHBvW7jbC4rr12C66Yb1qvOhPkos3PF4HLtWRv_Ti/exec';

        // Navigation
        function showTab(tab) {
            document.querySelectorAll('.content-area').forEach(s => s.style.display = 'none');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab + 'Sec').style.display = 'block';
            event.currentTarget.classList.add('active');
            if(tab === 'game') initBird(); else bActive = false;
        }

        function toggleAuth() {
            document.getElementById('loginForm').classList.toggle('hidden');
            document.getElementById('regForm').classList.toggle('hidden');
        }

        // Login
        function handleLogin() {
            const u = document.getElementById('user').value, p = document.getElementById('pass').value;
            if(!u || !p) return;
            fetch(scriptURL, { method: 'POST', body: JSON.stringify({ type: "LOGIN", user: u, pass: p }) })
            .then(res => res.json()).then(data => {
                if(data.result === "success") {
                    document.getElementById('authScreen').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('authScreen').style.display = 'none';
                        document.getElementById('bottomNav').style.display = 'flex';
                        showTab('planner');
                    }, 500);
                } else alert("Mali ang login!");
            });
        }

        // Add Task to Sheet
        function addTask() {
            const task = document.getElementById('taskName').value, user = document.getElementById('user').value;
            if(!task) return;
            fetch(scriptURL, { method: 'POST', body: JSON.stringify({ type: "TASK", user: user, task: task }) });
            
            const div = document.createElement('div');
            div.className = 'task-item';
            div.innerHTML = `<span>${task}</span><small>Sent!</small>`;
            document.getElementById('taskList').prepend(div);
            document.getElementById('taskName').value = "";
        }

        // Game Logic (Mobile Touch Ready)
        const canvas = document.getElementById('birdCanvas'), ctx = canvas.getContext('2d');
        let bird, pipes, bScore, bActive = false;

        function initBird() {
            bird = { x: 50, y: 150, v: 0, g: 0.25 };
            pipes = []; bScore = 0; bActive = true;
            document.getElementById('scoreLabel').innerText = "Score: 0";
            updateGame();
        }

        function saveScore(s) {
            const u = document.getElementById('user').value;
            fetch(scriptURL, { method: 'POST', body: JSON.stringify({ type: "SCORE", user: u, score: s }) });
        }

        function updateGame() {
            if(!bActive) return;
            ctx.fillStyle = "#0b101b"; ctx.fillRect(0, 0, 320, 480);
            
            bird.v += bird.g; bird.y += bird.v;
            ctx.font = "30px Arial"; ctx.fillText("üê¶", bird.x, bird.y);

            if(pipes.length === 0 || pipes[pipes.length - 1].x < 150) {
                let gap = 120, top = Math.random() * (canvas.height - gap - 100) + 50;
                pipes.push({ x: 320, t: top, b: top + gap });
            }

            pipes.forEach((p, i) => {
                p.x -= 2;
                ctx.fillStyle = "rgba(0, 242, 255, 0.3)";
                ctx.fillRect(p.x, 0, 40, p.t);
                ctx.fillRect(p.x, p.b, 40, 480);

                if(p.x === 50) { bScore++; document.getElementById('scoreLabel').innerText = "Score: " + bScore; }
                if(bird.y > 480 || bird.y < 0 || (bird.x + 20 > p.x && bird.x < p.x + 40 && (bird.y - 20 < p.t || bird.y > p.b))) {
                    bActive = false; saveScore(bScore); alert("Game Over! Score Saved.");
                }
                if(p.x < -40) pipes.splice(i, 1);
            });
            requestAnimationFrame(updateGame);
        }

        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); bird.v = -5; });
        window.onkeydown = (e) => { if(e.code === 'Space') bird.v = -5; };

        // BG Particles
        const bg = document.getElementById('bgCanvas'), bctx = bg.getContext('2d');
        function resize() { bg.width = window.innerWidth; bg.height = window.innerHeight; } resize();
        let particles = Array(60).fill().map(() => ({ x: Math.random() * bg.width, y: Math.random() * bg.height, s: Math.random() * 2 }));
        function drawBg() {
            bctx.clearRect(0,0,bg.width,bg.height); bctx.fillStyle = "rgba(0,242,255,0.2)";
            particles.forEach(p => { p.y -= 0.5; if(p.y < 0) p.y = bg.height; bctx.beginPath(); bctx.arc(p.x, p.y, p.s, 0, Math.PI*2); bctx.fill(); });
            requestAnimationFrame(drawBg);
        }
        drawBg();
    </script>
</body>
</html>
